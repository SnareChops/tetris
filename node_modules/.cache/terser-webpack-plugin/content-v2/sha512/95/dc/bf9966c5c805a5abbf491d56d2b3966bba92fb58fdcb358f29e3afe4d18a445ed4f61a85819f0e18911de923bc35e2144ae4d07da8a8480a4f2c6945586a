{"code":"!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,\"a\",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p=\"\",s(s.s=0)}([function(t,e,s){\"use strict\";s.r(e);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst i=new WeakMap,o=t=>\"function\"==typeof t&&i.has(t),n=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,r=(t,e,s=null)=>{let i=e;for(;i!==s;){const e=i.nextSibling;t.removeChild(i),i=e}},a={},h={},l=`{{lit-${String(Math.random()).slice(2)}}}`,c=`\\x3c!--${l}--\\x3e`,d=new RegExp(`${l}|${c}`),u=\"$lit$\";class p{constructor(t,e){this.parts=[],this.element=e;let s=-1,i=0;const o=[],n=e=>{const r=e.content,a=document.createTreeWalker(r,133,null,!1);let h=0;for(;a.nextNode();){s++;const e=a.currentNode;if(1===e.nodeType){if(e.hasAttributes()){const o=e.attributes;let n=0;for(let t=0;t<o.length;t++)o[t].value.indexOf(l)>=0&&n++;for(;n-- >0;){const o=t.strings[i],n=b.exec(o)[2],r=n.toLowerCase()+u,a=e.getAttribute(r).split(d);this.parts.push({type:\"attribute\",index:s,name:n,strings:a}),e.removeAttribute(r),i+=a.length-1}}\"TEMPLATE\"===e.tagName&&n(e)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(l)>=0){const n=e.parentNode,r=t.split(d),a=r.length-1;for(let t=0;t<a;t++)n.insertBefore(\"\"===r[t]?x():document.createTextNode(r[t]),e),this.parts.push({type:\"node\",index:++s});\"\"===r[a]?(n.insertBefore(x(),e),o.push(e)):e.data=r[a],i+=a}}else if(8===e.nodeType)if(e.data===l){const t=e.parentNode;null!==e.previousSibling&&s!==h||(s++,t.insertBefore(x(),e)),h=s,this.parts.push({type:\"node\",index:s}),null===e.nextSibling?e.data=\"\":(o.push(e),s--),i++}else{let t=-1;for(;-1!==(t=e.data.indexOf(l,t+1));)this.parts.push({type:\"node\",index:-1})}}};n(e);for(const t of o)t.parentNode.removeChild(t)}}const m=t=>-1!==t.index,x=()=>document.createComment(\"\"),b=/([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \\x09\\x0a\\x0c\\x0d\"'>=\\/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass g{constructor(t,e,s){this._parts=[],this.template=t,this.processor=e,this.options=s}update(t){let e=0;for(const s of this._parts)void 0!==s&&s.setValue(t[e]),e++;for(const t of this._parts)void 0!==t&&t.commit()}_clone(){const t=n?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=this.template.parts;let s=0,i=0;const o=t=>{const n=document.createTreeWalker(t,133,null,!1);let r=n.nextNode();for(;s<e.length&&null!==r;){const t=e[s];if(m(t))if(i===t.index){if(\"node\"===t.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(r.previousSibling),this._parts.push(t)}else this._parts.push(...this.processor.handleAttributeExpressions(r,t.name,t.strings,this.options));s++}else i++,\"TEMPLATE\"===r.nodeName&&o(r.content),r=n.nextNode();else this._parts.push(void 0),s++}};return o(t),n&&(document.adoptNode(t),customElements.upgrade(t)),t}}\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class y{constructor(t,e,s,i){this.strings=t,this.values=e,this.type=s,this.processor=i}getHTML(){const t=this.strings.length-1;let e=\"\";for(let s=0;s<t;s++){const t=this.strings[s],i=b.exec(t);e+=i?t.substr(0,i.index)+i[1]+i[2]+u+i[3]+l:t+c}return e+this.strings[t]}getTemplateElement(){const t=document.createElement(\"template\");return t.innerHTML=this.getHTML(),t}}\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst f=t=>null===t||!(\"object\"==typeof t||\"function\"==typeof t);class v{constructor(t,e,s){this.dirty=!0,this.element=t,this.name=e,this.strings=s,this.parts=[];for(let t=0;t<s.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new w(this)}_getValue(){const t=this.strings,e=t.length-1;let s=\"\";for(let i=0;i<e;i++){s+=t[i];const e=this.parts[i];if(void 0!==e){const t=e.value;if(null!=t&&(Array.isArray(t)||\"string\"!=typeof t&&t[Symbol.iterator]))for(const e of t)s+=\"string\"==typeof e?e:String(e);else s+=\"string\"==typeof t?t:String(t)}}return s+=t[e]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class w{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===a||f(t)&&t===this.value||(this.value=t,o(t)||(this.committer.dirty=!0))}commit(){for(;o(this.value);){const t=this.value;this.value=a,t(this)}this.value!==a&&this.committer.commit()}}class k{constructor(t){this.value=void 0,this._pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(x()),this.endNode=t.appendChild(x())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t._insert(this.startNode=x()),t._insert(this.endNode=x())}insertAfterPart(t){t._insert(this.startNode=x()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this._pendingValue=t}commit(){for(;o(this._pendingValue);){const t=this._pendingValue;this._pendingValue=a,t(this)}const t=this._pendingValue;t!==a&&(f(t)?t!==this.value&&this._commitText(t):t instanceof y?this._commitTemplateResult(t):t instanceof Node?this._commitNode(t):Array.isArray(t)||t[Symbol.iterator]?this._commitIterable(t):t===h?(this.value=h,this.clear()):this._commitText(t))}_insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}_commitNode(t){this.value!==t&&(this.clear(),this._insert(t),this.value=t)}_commitText(t){const e=this.startNode.nextSibling;t=null==t?\"\":t,e===this.endNode.previousSibling&&3===e.nodeType?e.data=t:this._commitNode(document.createTextNode(\"string\"==typeof t?t:String(t))),this.value=t}_commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value&&this.value.template===e)this.value.update(t.values);else{const s=new g(e,t.processor,this.options),i=s._clone();s.update(t.values),this._commitNode(i),this.value=s}}_commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let s,i=0;for(const o of t)void 0===(s=e[i])&&(s=new k(this.options),e.push(s),0===i?s.appendIntoPart(this):s.insertAfterPart(e[i-1])),s.setValue(o),s.commit(),i++;i<e.length&&(e.length=i,this.clear(s&&s.endNode))}clear(t=this.startNode){r(this.startNode.parentNode,t.nextSibling,this.endNode)}}class _{constructor(t,e,s){if(this.value=void 0,this._pendingValue=void 0,2!==s.length||\"\"!==s[0]||\"\"!==s[1])throw new Error(\"Boolean attributes can only contain a single expression\");this.element=t,this.name=e,this.strings=s}setValue(t){this._pendingValue=t}commit(){for(;o(this._pendingValue);){const t=this._pendingValue;this._pendingValue=a,t(this)}if(this._pendingValue===a)return;const t=!!this._pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,\"\"):this.element.removeAttribute(this.name)),this.value=t,this._pendingValue=a}}class N extends v{constructor(t,e,s){super(t,e,s),this.single=2===s.length&&\"\"===s[0]&&\"\"===s[1]}_createPart(){return new E(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class E extends w{}let M=!1;try{const t={get capture(){return M=!0,!1}};window.addEventListener(\"test\",t,t),window.removeEventListener(\"test\",t,t)}catch(t){}class T{constructor(t,e,s){this.value=void 0,this._pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=s,this._boundHandleEvent=(t=>this.handleEvent(t))}setValue(t){this._pendingValue=t}commit(){for(;o(this._pendingValue);){const t=this._pendingValue;this._pendingValue=a,t(this)}if(this._pendingValue===a)return;const t=this._pendingValue,e=this.value,s=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),i=null!=t&&(null==e||s);s&&this.element.removeEventListener(this.eventName,this._boundHandleEvent,this._options),i&&(this._options=C(t),this.element.addEventListener(this.eventName,this._boundHandleEvent,this._options)),this.value=t,this._pendingValue=a}handleEvent(t){\"function\"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const C=t=>t&&(M?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const V=new class{handleAttributeExpressions(t,e,s,i){const o=e[0];return\".\"===o?new N(t,e.slice(1),s).parts:\"@\"===o?[new T(t,e.slice(1),i.eventContext)]:\"?\"===o?[new _(t,e.slice(1),s)]:new v(t,e,s).parts}handleTextExpression(t){return new k(t)}};\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */function S(t){let e=A.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},A.set(t.type,e));let s=e.stringsArray.get(t.strings);if(void 0!==s)return s;const i=t.strings.join(l);return void 0===(s=e.keyString.get(i))&&(s=new p(t,t.getTemplateElement()),e.keyString.set(i,s)),e.stringsArray.set(t.strings,s),s}const A=new Map,L=new WeakMap,P=(t,e,s)=>{let i=L.get(e);void 0===i&&(r(e,e.firstChild),L.set(e,i=new k(Object.assign({templateFactory:S},s))),i.appendInto(e)),i.setValue(t),i.commit()},O=(t,...e)=>new y(t,e,\"html\",V);\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class ${constructor(t,e){this.board=t,this.game=e,this.blockMoveCounter=0,this.speed=31,this.paused=!1}start(){this.blockMoveCounter=0,window.requestAnimationFrame(this.tick.bind(this))}pause(){this.paused=!0}resume(){this.paused=!1,window.requestAnimationFrame(this.tick.bind(this))}tick(){this.clear(),this.autoBlockMove(),this.board.checkBlobRows(),this.game.draw(),this.paused||window.requestAnimationFrame(this.tick.bind(this))}clear(){document.querySelectorAll(\"cell-\").forEach(t=>t.style.background=\"white\")}autoBlockMove(){this.blockMoveCounter++,this.blockMoveCounter>(this.speed<0?0:this.speed)&&(this.blockMoveCounter=0,null==this.board.block?(this.board.newBlock(),this.game.incrementBlockCount()):this.board.block.moveDown(this.board))}increaseSpeed(){this.speed--}}const B=t=>O`\n  <wrapper>\n    <menu .game=${t}></menu>\n    <board- .game=${t} rows=\"20\" cols=\"10\"></board->\n  </wrapper>\n`,H=t=>O`\n  <splash>\n    <h1>Game Over!</h1>\n    <p><em>Thanks for playing!</em></p>\n    <p>Final Score: ${t.score}</p>\n    <p>Time Played: ${t.time}</p>\n    <p>Number of Blocks: ${t.blockCount}</p>\n  </splash>\n`;customElements.define(\"game-\",class extends HTMLElement{constructor(t,e){super(),this.paused=!1,this.isGameOver=!1,this.score=0,this.blockCount=0,this.controls=t,this.displays=e,document.addEventListener(\"keydown\",t=>{if(null!=this.board.block)switch(t.which){case this.controls.left:this.board.block.moveLeft(this.board);break;case this.controls.right:this.board.block.moveRight(this.board);break;case this.controls.down:this.board.block.moveDown(this.board);break;case this.controls.rotate:this.board.block.rotateRight(this.board)}}),this.controls.new.addEventListener(\"click\",this.start.bind(this)),this.controls.pause.addEventListener(\"click\",this.pause.bind(this)),window.addEventListener(\"dblclick\",this.pause.bind(this))}connectedCallback(){P(B(this),this),this.board=this.querySelector(\"board\"),this.$intro=this.querySelector(\"intro\"),this.$wrapper=this.querySelector(\"wrapper\"),this.menu=this.querySelector(\"menu\")}addPoints(t){this.score+=t,this.displays.score.innerHTML=this.score.toString()}incrementBlockCount(){this.blockCount++,this.displays.blockCount.innerHTML=this.blockCount.toString()}start(){this.isGameOver=!1,this.paused=!1,this.board.clear(),this.score=0,this.blockCount=0,this.displays.score.innerHTML=\"0\",this.displays.blockCount.innerHTML=\"0\",this.engine=new $(this.board,this),this.engine.start()}pause(){this.isGameOver||(this.paused?(this.controls.pause.textContent=\"Pause Game\",this.engine.resume(),this.paused=!1):(this.controls.pause.textContent=\"Resume Game\",this.engine.pause(),this.paused=!0))}draw(){this.board.draw(),this.menu.draw()}gameOver(){this.pause(),P(H(this),this.board.querySelector(\".paused\")),this.isGameOver=!0}});const R=[{coordinates:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:3,y:0}],color:\"#00f0f0\"},{coordinates:[{x:0,y:0},{x:0,y:1},{x:1,y:0},{x:2,y:0}],color:\"#0000f0\"},{coordinates:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:2,y:1}],color:\"#f0a000\"},{coordinates:[{x:0,y:0},{x:0,y:1},{x:1,y:0},{x:1,y:1}],color:\"#f0f000\"},{coordinates:[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:2,y:1}],color:\"#f0f000\"},{coordinates:[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:2,y:0}],color:\"#a0f000\"},{coordinates:[{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:2,y:0}],color:\"#f00000\"}];class j{constructor(t){var e;this.min={x:0,y:0},this.coordinates=R[t].coordinates,this.color=R[t].color,this.max=(e=this.coordinates,{x:Math.max(...e.map(t=>t.x)),y:Math.max(...e.map(t=>t.y))})}}class F{get color(){return this.shape.color}constructor(t,e,s){this.shape=new j(t),this.position={x:e,y:s},this.max={x:this.shape.max.x+this.position.x,y:this.shape.max.y+this.position.y},this.min={x:this.shape.min.x+this.position.x,y:this.shape.min.y+this.position.y}}moveDown(t){if(this.collision(t,{x:this.position.x,y:this.position.y-1},this.shape.coordinates)){for(const e of this.shape.coordinates)t.blob[e.y+this.position.y].push(e.x+this.position.x);return t.block=void 0,!1}return this.position.y--,!0}moveRight(t){return!this.collision(t,{x:this.position.x+1,y:this.position.y},this.shape.coordinates)&&(this.position.x++,!0)}moveLeft(t){return!this.collision(t,{x:this.position.x-1,y:this.position.y},this.shape.coordinates)&&(this.position.x--,!0)}rotateRight(t){var e=Math.floor(this.shape.max.x/2),s=Math.floor(this.shape.max.y/2),i=[];for(const t of this.shape.coordinates){var o=q(t.x-e,t.y-s);i.push({x:o.x,y:o.y})}return!this.collision(t,this.position,i)&&(this.shape.coordinates=i,!0)}draw(t){for(const i of this.shape.coordinates){var e=i.x+this.position.x,s=i.y+this.position.y;t.rows[s].cells[e].style.backgroundColor=this.color}}collision(t,e,s){return!s.every(s=>{if(s.x+e.x<t.bounds.min.x)return!1;if(s.y+e.y<t.bounds.min.y)return!1;if(s.x+e.x>t.bounds.max.x)return!1;if(s.y+e.y>t.bounds.max.y)return!1;for(const i in t.blob)if(!t.blob[i].every(t=>{return!(s.x+e.x===t&&s.y+e.y===parseInt(i))}))return!1;return!0})}}function q(t,e){var s=0,i=0;return t<0&&(i=-1*t),e>0&&(s=e),t>0&&(i=-1*t),e<0&&(s=e),{x:s,y:i}}class G extends HTMLElement{}customElements.define(\"row-\",G);class I extends HTMLElement{}customElements.define(\"cell-\",I);customElements.define(\"board-\",class extends HTMLElement{constructor(){super(...arguments),this.rows=[],this.blob={}}get rowNumber(){const t=this.getAttribute(\"rows\");return t?+t:0}get colNumber(){const t=this.getAttribute(\"cols\");return t?+t:0}connectedCallback(){this.bounds={max:{x:this.rowNumber-1,y:this.colNumber-1},min:{x:0,y:0}};for(let t=0;t<this.rowNumber;t++){this.blob[t]=[];const e=new G;for(let t=0;t<this.colNumber;t++){const t=new I;e.append(t),e.cells.push(t)}this.append(e),this.rows.push(e)}this.rows=this.rows.reverse()}newBlock(){this.block=new F(Math.floor(6*Math.random()),4,18),this.block.collision(this,{x:4,y:18},this.block.shape.coordinates)&&this.game.gameOver()}clear(){this.innerHTML=\"\"}draw(){null!=this.block&&this.block.draw(this);for(let t=0;t<this.rows.length;t++)for(let e=0;e<this.blob[t].length;e++)this.rows[t].cells[this.blob[t][e]].style.backgroundColor=\"green\"}checkBlobRows(){for(let t=0;t<this.rows.length;t++)this.blob[t].length>=this.rows[t].cells.length&&(this.dropRows(t),this.game.addPoints(10))}dropRows(t){for(let e=t;e<this.rows.length;e++)e===this.rows.length-1?this.blob[e]=[]:this.blob[e]=this.blob[e+1]}});const W=t=>t.game.paused?O`\n        <paused></paused>\n      `:O`\n        <h1>Chops Blocks</h1>\n        <new-game @click=${()=>t.game.start()}>New game</new-game>\n        <pause-game @click=${()=>t.game.pause()}>Pause game</pause-game>\n        <p>Score: ${t.game.score} Blocks: ${t.game.blockCount}</p>\n      `;customElements.define(\"menu-\",class extends HTMLElement{connectedCallback(){this.draw()}draw(){P(W(this),this)}})}]);","extractedComments":[]}